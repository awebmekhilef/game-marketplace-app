<!doctype html>
<html lang = 'en'>
	<head>
		<meta charset = 'UTF-8'>
		<meta name = 'viewport' content = 'width=device-width, initial-scale=1, shrink-to-fit=no'>

		<title>Game Marketplace</title>

		<link rel = 'stylesheet' href = 'https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css'
					integrity = 'sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2'
					crossorigin = 'anonymous'>

		<!--	BOOTSTRAP	-->
		<script src = 'https://code.jquery.com/jquery-3.5.1.slim.min.js'
						integrity = 'sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj'
						crossorigin = 'anonymous'></script>
		<script src = 'https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js'
						integrity = 'sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx'
						crossorigin = 'anonymous'></script>
		<script src = 'https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.min.js'></script>

		<!--	FILEPOND	-->
		<link href = 'https://unpkg.com/filepond/dist/filepond.css' rel = 'stylesheet'>
		<link href = 'https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css'
					rel = 'stylesheet'>

	</head>
	<body class = 'bg-light d-flex flex-column min-vh-100'>
		<%- include('../partials/navbar') %>

		<div class = 'container-md'>
			<%- body %>
		</div>

		<%- include('../partials/footer') %>

		<script src = 'https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js'></script>
		<script src = 'https://unpkg.com/filepond/dist/filepond.js'></script>

		<script src = 'https://unpkg.com/filepond-plugin-image-resize/dist/filepond-plugin-image-resize.js'></script>
		<script src = 'https://unpkg.com/filepond/dist/filepond.js'></script>

		<script src = 'https://unpkg.com/filepond-plugin-file-encode/dist/filepond-plugin-file-encode.js'></script>
		<script src = 'https://unpkg.com/filepond/dist/filepond.js'></script>

		<script
				src = 'https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js'></script>
		<script src = 'https://unpkg.com/filepond/dist/filepond.js'></script>

		<script src = 'https://unpkg.com/filepond-plugin-image-transform/dist/filepond-plugin-image-transform.js'></script>
		<script src = 'https://unpkg.com/filepond/dist/filepond.js'></script>

		<script>
		$(document).ready(function () {
			bsCustomFileInput.init()
		})

		FilePond.registerPlugin(
			FilePondPluginImagePreview,
			FilePondPluginImageResize,
			FilePondPluginFileEncode,
			FilePondPluginFileValidateType,
			FilePondPluginImageTransform
		)

		FilePond.setOptions({
			stylePanelAspectRatio: 250 / 315,
			imageResizeTargetWidth: 315,
			imageResizeTargetHeight: 250,
		})

		const inputElement = document.querySelector('#file-pond');
		const pond = FilePond.create(inputElement, {
			credits: false,
			acceptedFileTypes: [ 'image/png', 'image/jpg', 'image/jpeg' ],
			fileValidateTypeLabelExpectedTypes: '',
			imageResizeMode: 'force'
		})

		const data = `<% if(locals.game && game.cover) { %><%= game.cover %><% } else { %><% } %>`

		if (data !== '')
			pond.addFile(data)
		</script>
	</body>
</html>